---
title: "finemapping"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{finemapping}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
library(gwasglue)
library(dplyr)

```


library(devtools)
load_all()


Finemapr


```{r}

v <- ieugwasr::variants_rsid("rs7528419")
r <- paste0(v[["chr"]], ":", v[["pos"]]-100000, "-", v[["pos"]]+100000)
a <- ieugwasr_to_finemapr(r, c("ieu-a-7", "ieu-a-2"))

options(finemapr_caviar = "/Users/gh13047/bin/caviar")
o <- finemapr::run_caviar(a[["ieu-a-7"]]$z, a[["ieu-a-7"]]$ld, args = "-c 3")

```

SusieR


```{r}
fitted_rss <- susieR::susie_rss(
	a[["ieu-a-7"]]$z$zscore, 
	a[["ieu-a-7"]]$ld, L=10, 
	estimate_residual_variance=TRUE, 
	estimate_prior_variance=TRUE, 
	check_R=FALSE, 
	z_ld_weight=1/500
)
summary(fitted_rss)
susieR::susie_plot(fitted_rss, y="PIP")
```
